import tmrm = require('azure-pipelines-task-lib/mock-run');
import path = require('path');

let taskPath = path.join(__dirname, '..', 'nugetvulnerabilityscan', 'index.js');
let tmr: tmrm.TaskMockRunner = new tmrm.TaskMockRunner(taskPath);
tmr.setAnswers({
    which: { ["dotnet"]: "dotnet" },
    checkPath: {
        ["dotnet"]: true,
        ["testpath"]: true
    },
    exec: { ["dotnet list package --deprecated"]: { stdout: "Project `Test` has the following deprecated packages", stderr: "", code: 0 } }
});

tmr.setInput('path', 'testpath');
tmr.setInput('type', 'deprecated');
tmr.setInput('warning', 'true');

tmr.run();
